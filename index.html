<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/* ===== NOTIFICAÇÕES ===== */
const NKEY='notifications'

function getN(){return JSON.parse(localStorage.getItem(NKEY))||[]}
function saveN(n){localStorage.setItem(NKEY,JSON.stringify(n))}
function addN(msg){
  const n=getN()
  n.unshift({id:Date.now(),msg,date:new Date().toISOString()})
  saveN(n);renderN()
}
function cleanN(){
  const now=new Date()
  saveN(getN().filter(n=>(now-new Date(n.date))/(1000*60*60*24)<=7))
}
function renderN(){
  cleanN()
  const box=document.getElementById('notifyBox')
  const c=document.getElementById('notifyCount')
  const n=getN()
  c.innerText=n.length
  box.innerHTML=n.length?n.map(i=>`
    <div class="notify">
      <div>${i.msg}<br><small>${new Date(i.date).toLocaleString()}</small></div>
      <button onclick="delN(${i.id})">✕</button>
    </div>`).join(''):'<div class="notify"><small>Sem notificações</small></div>'
}
function delN(id){saveN(getN().filter(n=>n.id!==id));renderN()}
function toggleNotify(){document.getElementById('notifyBox').classList.toggle('active')}

/* CHAMADAS EXISTENTES + NOTIFICAÇÃO */
const oldAdd=adicionar
adicionar=function(){
  oldAdd()
  addN(`Novo ${tipoSelecionado} adicionado`)
}

function adicionarCliente(){
  addN('Novo cliente adicionado')
}

renderN()
</script>

</body>
</html>
