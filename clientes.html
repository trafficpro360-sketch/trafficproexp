<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finance Pro ‚Äî Clientes</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg-main:#020617;
  --border:#1e293b;
  --blue:#38bdf8;
  --red:#ef4444;
  --green:#22c55e;
  --text:#e5e7eb;
  --muted:#94a3b8;
}
  
*{margin:0;padding:0;box-sizing:border-box}

/* REMOVE √çCONE DE CALEND√ÅRIO E SETAS EM QUALQUER INPUT */
input::-webkit-calendar-picker-indicator {
  display: none !important;
  -webkit-appearance: none;
}

input[type="text"]::-webkit-inner-spin-button,
input[type="text"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, Helvetica, sans-serif;
  font-size: 15px;
  line-height: 1.65;
  letter-spacing: 0.01em;
  background:radial-gradient(1200px 600px at 10% -10%, #0f172a, #020617);
  color:var(--text);
  min-height:100vh;
  display:flex;
  padding:0;   /* muito importante */
}


/* HEADER */
.top-bar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
  margin-bottom:28px;
}

  /* SIDEBAR IGUAL AO INDEX */
.sidebar{
  width:280px;
  backdrop-filter:blur(20px);
  background:rgba(2,6,23,.85);
  border-right:1px solid var(--border);
  padding:28px;
  border-radius: 0 28px 28px 0;
  height:100vh;
}

.logo{
  font-size:24px;
  font-weight:700;
  color:var(--blue);
  margin-bottom:48px;
}

.menu a{
  line-height:1.4;
  cursor:pointer;
}

.menu ul{list-style:none}
.menu li{margin-bottom:12px}

.menu a{
  display:block;
  padding:14px 18px;
  border-radius:18px;
  color:var(--muted);
  text-decoration:none;
  transition:.2s ease;
  font-size:15px;
}

.menu li.active a,
.menu a:hover{
  background:rgba(56,189,248,.18);
  color:var(--blue);
}


.content{
  flex:1;
  padding:28px 24px;   /* mant√©m um respiro bonito */
  width:100%;           /* ocupa toda a √°rea dispon√≠vel */
  max-width:100%;       /* REMOVE o limite centralizado */
}

.header{
  font-size:32px;
  font-weight:700;
  letter-spacing: 0.02em;
}

.acoes{
  display:flex;
  gap:12px;
}

.acoes-topo{
  display:flex;
  align-items:center;
  gap:14px;
  justify-content:flex-end;   /* <-- MUITO IMPORTANTE */
}


.btn-exportar{
  padding:10px 16px;
  border-radius:14px;
  border:1px solid var(--blue);
  background:rgba(56,189,248,.12);
  color:var(--blue);
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

.btn-exportar:hover{
  background:rgba(56,189,248,.22);
}

/* BOT√ÉO + MODERNO */
.btn-plus{
  width:42px;
  height:42px;
  border-radius:14px;
  border:1px solid rgba(56,189,248,.4);
  background:linear-gradient(135deg,#2563eb,#38bdf8);
  color:white;
  font-size:22px;
  font-weight:700;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:.15s ease;
}

.btn-plus:hover{
  transform:scale(1.05);
  box-shadow:0 0 10px rgba(56,189,248,.4);
}

/* BOT√ïES DE A√á√ÉO NAS TAREFAS ‚Äî PADR√ÉO INDEX */
.btn-group{
  display:flex;
  gap:10px;
  align-items:center;
}

.btn-edit,.btn-del,.btn-done{
  border:none;
  padding:7px 10px;
  border-radius:12px;
  font-size:12px;
  cursor:pointer;
}

.btn-edit{
  background:rgba(56,189,248,.15);
  color:var(--blue);
  border:1px solid var(--blue);
}

.btn-del{
  background:rgba(239,68,68,.15);
  color:var(--red);
  border:1px solid var(--red);
}

.btn-done{
  background:rgba(34,197,94,.15);
  color:var(--green);
  border:1px solid var(--green);
}

/* tarefa conclu√≠da */
.tarefa-concluida{
  opacity:.6;
  text-decoration: line-through;
}



.notificacao-area{
  position:relative;
  font-size:22px;
  cursor:pointer;
  padding:10px;
}

/* bolinha vermelha */
#notifBadge{
  position:absolute;
  top:4px;
  right:2px;
  background:red;
  color:white;
  font-size:12px;
  border-radius:50%;
  padding:2px 6px;
}

/* painel lateral */
#painelNotificacoes{
  position:fixed;
  top:90px;
  right:40px;
  width:320px;
  background:rgba(15,23,42,.95);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px 8px 16px 16px;
  display:none;
  max-height:400px;
  overflow-y:auto;
  box-shadow:0 8px 30px rgba(0,0,0,.4);
  z-index:9999;

  scrollbar-width: thin;
  scrollbar-color: rgba(56,189,248,.4) rgba(2,6,23,.8);
}

#painelNotificacoes h3{
  margin-bottom:10px;
  color:var(--text);
}

#painelNotificacoes li{
  background:rgba(2,6,23,.6);
  padding:10px;
  border-radius:12px;
  margin-bottom:8px;
  font-size:14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.btn-notif-del{
  background:rgba(239,68,68,.2);
  color:var(--red);
  border:1px solid var(--red);
  border-radius:10px;
  padding:4px 8px;
  font-size:12px;
  cursor:pointer;
  margin-left:10px;
}


/* BOT√ïES */
.btn{
  padding:12px 16px;
  border-radius:16px;
  border:none;
  background:linear-gradient(135deg,#2563eb,#38bdf8);
  color:#fff;
  font-weight:600;
  cursor:pointer;
  white-space:nowrap;
}

/* FILTRO DE DATAS */
.controls{
  display:flex;
  align-items:center;
  gap:14px;
  margin-bottom:24px;
  flex-wrap:wrap;
  width:100%;
  justify-content:flex-start;   /* mant√©m alinhado √† esquerda */
}

.controls input{
  padding:13px 16px;
  border-radius:18px;
  border:1px solid var(--border);
  background:rgba(15,23,42,.8);
  color:#fff;
  font-size:15px;
  min-width:160px;
}

.texto-ate{
  color: var(--muted);
  font-size: 15px;
  margin: 0 6px;
}


/* CARD / GR√ÅFICO */
.card{
  backdrop-filter:blur(16px);
  background:rgba(15,23,42,.7);
  border:1px solid var(--border);
  border-radius:26px;
  padding:26px 28px;
  box-shadow:0 8px 30px rgba(0,0,0,.35);
  margin-bottom: 36px;
  width:100%;      /* <-- MUITO IMPORTANTE */
}
    transition:.2s ease;
}
.card:hover{
  transform:translateY(-2px);
}


.chart{
  height: 420px;      /* espa√ßo extra para os bot√µes */
  margin-bottom: 32px;
  display:flex;
  flex-direction:column;
  gap:16px;
}


/* TAREFAS */
.tarefas input{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:14px;
  border:1px solid var(--border);
  background:rgba(2,6,23,.7);
  color:#fff;
}

.tarefas ul{
  list-style:none;
  margin-top:10px;
}

.tarefas li{
  background:rgba(2,6,23,.6);
  padding:14px;
  border-radius:16px;
  margin-bottom:10px;
  font-size:14px;
  border:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  backdrop-filter:blur(6px);
}

.modal.active{display:flex}

.modal-content{
  width:360px;
  background: linear-gradient(
    180deg,
    rgba(56,189,248,.05),
    rgba(15,23,42,.95)
  );
  backdrop-filter: blur(10px);
  border:1px solid rgba(56,189,248,.18);
  border-radius:28px;
  padding:28px 32px;
}


.modal-content h3{
  margin-bottom:12px;
}

.modal-content input{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:14px;
  border:1px solid var(--border);
  background:rgba(2,6,23,.7);
  color:#fff;
}

.modal-content button{
  width:100%;
  padding:12px 14px;
  border-radius:16px;
  border:none;
  font-weight:600;
  cursor:pointer;
  margin-top:8px;
  transition:.15s ease;
}
  
.modal-content button:first-of-type{
  background:linear-gradient(135deg,#2563eb,#38bdf8);
  color:white;
}

.modal-content button:last-of-type{
  background:rgba(239,68,68,.15);
  color:var(--red);
  border:1px solid var(--red);
}


/* PAINEL LATERAL DE CLIENTES */
#painelClientes{
  position:fixed;
  top:90px;
  right:40px;
  width:340px;              /* um pouco maior */
  background:rgba(15,23,42,.95);
  border:1px solid var(--border);
  border-radius:20px;
  padding:18px 10px 18px 18px;
  display:none;
  max-height:450px;         /* um pouco mais alto */
  overflow-y:auto;
  box-shadow:0 8px 30px rgba(0,0,0,.4);
  backdrop-filter: blur(10px);
  z-index:9999;
  
  scrollbar-width: thin;
  scrollbar-color: rgba(56,189,248,.4) rgba(2,6,23,.8);  
}

#painelClientes h3{
  margin-bottom:12px;
}

#painelClientes li{
  background:rgba(2,6,23,.6);
  padding:12px;
  border-radius:14px;
  margin-bottom:10px;
  font-size:14px;
  border:1px solid var(--border);
}

/* ===== PADR√ÉO DE SCROLLBAR IGUAL AO INDEX ===== */

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(2,6,23,.8);
}

::-webkit-scrollbar-thumb {
  background: rgba(56,189,248,.3);
  border-radius: 20px;
  border: 2px solid rgba(2,6,23,.8);
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(56,189,248,.5);
}

</style>
</head>

<body>

<aside class="sidebar">
  <div class="logo">Finance<span style="color:#fff">Pro</span></div>
  <nav class="menu">
    <ul>
      <li><a href="index.html">Dashboard</a></li>
      <li class="active"><a href="clientes.html">Clientes</a></li>
    </ul>
  </nav>
</aside>

<main class="content">
<div class="top-bar">

  <div class="header">Clientes</div>

  <div class="acoes-topo">

    <button class="btn-plus" onclick="abrirModalCliente()">
      <span>+</span>
    </button>

    <button class="btn-exportar" onclick="togglePainel()">
      Meus clientes
    </button>

    <div class="notificacao-area" onclick="toggleNotificacoes()">
      üîî
      <span id="notifBadge">0</span>
    </div>

  </div>

</div>

<div class="controls">
  <input type="text" id="filtroInicio" placeholder="dd/mm/aaaa">

  <span class="texto-ate">at√©</span>

  <input type="text" id="filtroFim" placeholder="dd/mm/aaaa">

  <button class="btn" onclick="atualizarGrafico()">Filtrar</button>
</div>

  
<div class="card">
  <h3>üí∞ Receita Total Mensal</h3>
  <p id="receitaTotal">Calculando...</p>
</div>

<div class="card chart">

  <div style="
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:16px;
  ">

    <h3>Clientes - Analise de lucros</h3>

    <div style="display:flex; gap:10px;">
      <button class="btn" onclick="filtroHoje()" style="padding:8px 12px;">Hoje</button>
      <button class="btn" onclick="filtro30()" style="padding:8px 12px;">30 dias</button>
      <button class="btn" onclick="filtro90()" style="padding:8px 12px;">90 dias</button>
      <button class="btn" onclick="filtroAno()" style="padding:8px 12px;">Este ano</button>
    </div>

  </div>

  <!-- √ÅREA SEGURA DO GR√ÅFICO -->
 <div style="flex:1; min-height:320px; padding:8px;">
  <canvas id="clientesChart"></canvas>
 </div>


</div>



<div class="card tarefas">
  <h3>Tarefas</h3>

  <input type="text" id="tData" placeholder="dd/mm/aaaa">
  <input type="time" id="tHora">
  <input type="text" id="tDesc" placeholder="Descri√ß√£o da tarefa">
  <button class="btn" onclick="adicionarTarefa()">Adicionar</button>

  <ul id="listaTarefas"></ul>
</div>
</main>

<!-- MODAL CLIENTE -->
<div class="modal" id="modalCliente">
  <div class="modal-content">
    <h3>Novo Cliente</h3>
    <input id="cNome" placeholder="Nome do cliente">
    <input id="cValor" type="number" placeholder="Valor mensal (R$)">
    <input id="cInicio" type="text" placeholder="dd/mm/aaaa">

<select id="cStatus" style="display:none;">
  <option value="Ativo">Ativo</option>
  <option value="Inativo">Inativo</option>
  <option value="Em teste">Em teste</option>
</select>

<div style="display:flex; gap:8px; margin:8px 0 12px 0;">
  <button class="btn" 
    style="background:#22c55e; font-size:12px; padding:8px; flex:1;"
    onclick="cStatus.value='Ativo'">
    Ativo
  </button>

  <button class="btn" 
    style="background:#facc15; color:#020617; font-size:12px; padding:8px; flex:1;"
    onclick="cStatus.value='Em teste'">
    Em teste
  </button>

  <button class="btn" 
    style="background:#ef4444; font-size:12px; padding:8px; flex:1;"
    onclick="cStatus.value='Inativo'">
    Inativo
  </button>
</div>

    <button onclick="salvarCliente()">Salvar</button>
    <button onclick="fecharModal()">Cancelar</button>
  </div>
</div>

<!-- PAINEL LISTA -->
<div id="painelClientes">
  <h3>Clientes</h3>

  <input 
    type="text" 
    id="buscaCliente" 
    placeholder="üîç Buscar cliente..." 
    onkeyup="filtrarClientes()"
    style="
      width:100%;
      padding:10px;
      margin-bottom:12px;
      border-radius:14px;
      border:1px solid var(--border);
      background:rgba(2,6,23,.7);
      color:white;
    "
  >

  <ul id="listaClientes"></ul>
</div>

  
<div id="painelNotificacoes">
  <h3>Notifica√ß√µes</h3>
  <ul id="listaNotificacoes"></ul>
</div>

<script>
let clientes = JSON.parse(localStorage.getItem("clientes")) || [];
let tarefas = JSON.parse(localStorage.getItem("tarefas")) || [];
let notificacoes = JSON.parse(localStorage.getItem("notificacoes")) || [];

  function formatarDataBR(data){
  if(!data) return "";

  // Se j√° estiver no padr√£o brasileiro, mant√©m como est√°
  if(data.includes("/")) return data;

  // Se vier em ISO (yyyy-mm-dd), converte para dd/mm/aaaa
  const d = new Date(data + "T00:00:00");
  return d.toLocaleDateString("pt-BR");
}

  function converterBRparaDate(dataBR){
  if(!dataBR) return null;

  const partes = dataBR.split("/");
  if(partes.length !== 3) return null;

  const [dia, mes, ano] = partes;
  return new Date(ano, mes - 1, dia);
}

const modalCliente = document.getElementById("modalCliente");
const painelClientes = document.getElementById("painelClientes");
const listaClientes = document.getElementById("listaClientes");
const listaTarefas = document.getElementById("listaTarefas");
const filtroInicio = document.getElementById("filtroInicio");
const filtroFim = document.getElementById("filtroFim");
const cNome = document.getElementById("cNome");
const cValor = document.getElementById("cValor");
const cInicio = document.getElementById("cInicio");
const cStatus = document.getElementById("cStatus");

const tData = document.getElementById("tData");
const tHora = document.getElementById("tHora");
const tDesc = document.getElementById("tDesc");

const chart = new Chart(document.getElementById("clientesChart"),{
  type:"line",
  data:{labels:[],datasets:[]},
  options:{
    responsive:true,
    maintainAspectRatio:false,

    layout: {
      padding: 12
    },

    plugins:{
      legend:{
        labels:{ color:"#e5e7eb" }
      }
    },

    scales:{
      x:{ ticks:{ color:"#94a3b8" }},
      y:{ ticks:{ color:"#94a3b8" }}
    }
  },
  plugins:[]
});


function registrarNotificacao(texto){
  const novaNotificacao = {
    id: Date.now(),
    texto: texto,
    data: new Date().toISOString()
  };

  notificacoes.push(novaNotificacao);

  const agora = new Date();
  notificacoes = notificacoes.filter(n => {
    const dataN = new Date(n.data);
    const diff = (agora - dataN) / (1000 * 60 * 60 * 24);
    return diff <= 3;
  });

  localStorage.setItem('notificacoes', JSON.stringify(notificacoes));
  atualizarPainelNotificacoes();
}

function atualizarPainelNotificacoes(){
  const lista = document.getElementById('listaNotificacoes');
  const badge = document.getElementById('notifBadge');

  lista.innerHTML = '';

  notificacoes.forEach(n => {
    const li = document.createElement('li');

    const dataFormatada = new Date(n.data).toLocaleString('pt-BR', {
      dateStyle: "short",
      timeStyle: "short"
    });

    li.innerHTML = `
      <div>
        <strong>${dataFormatada}</strong><br>
        ${n.texto}
      </div>
      <button class="btn-notif-del" onclick="excluirNotificacao(${n.id})">‚úñ</button>
    `;

    lista.appendChild(li);
  });

  badge.textContent = notificacoes.length;
}

function excluirNotificacao(id){
  notificacoes = notificacoes.filter(n => n.id !== id);
  localStorage.setItem('notificacoes', JSON.stringify(notificacoes));
  atualizarPainelNotificacoes();
}

function toggleNotificacoes(){
  const painel = document.getElementById('painelNotificacoes');
  painel.style.display = painel.style.display === 'block' ? 'none' : 'block';
}

function abrirModalCliente(){
  modalCliente.classList.add("active");
}

function fecharModal(){
  modalCliente.classList.remove("active");
}

function salvarCliente(){
  clientes.push({
    id: Date.now(),
    nome: cNome.value,
    valor: Number(cValor.value),
    inicio: cInicio.value,
    status: cStatus.value
  });

  localStorage.setItem("clientes", JSON.stringify(clientes));
  registrarNotificacao(`Novo cliente cadastrado: ${cNome.value}`);

  cNome.value = "";
  cValor.value = "";
  cInicio.value = "";

  fecharModal();
  atualizarGrafico();
  calcularReceitaTotal();
  renderClientes();
}

  function calcularReceitaTotal(){
  let total = clientes.reduce((soma, c) => soma + Number(c.valor), 0);

  document.getElementById("receitaTotal").textContent =
    total.toLocaleString("pt-BR", {style:"currency", currency:"BRL"});
}

  function formatarBR(d){
  return d.toLocaleDateString("pt-BR");
}

function filtroHoje(){
  const hoje = new Date();
  filtroInicio.value = formatarBR(hoje);
  filtroFim.value = formatarBR(hoje);
  atualizarGrafico();
}

function filtro30(){
  const hoje = new Date();
  const antes = new Date();
  antes.setDate(hoje.getDate() - 30);

  filtroInicio.value = formatarBR(antes);
  filtroFim.value = formatarBR(hoje);
  atualizarGrafico();
}

function filtro90(){
  const hoje = new Date();
  const antes = new Date();
  antes.setDate(hoje.getDate() - 90);

  filtroInicio.value = formatarBR(antes);
  filtroFim.value = formatarBR(hoje);
  atualizarGrafico();
}

function filtroAno(){
  const hoje = new Date();
  filtroInicio.value = "01/01/" + hoje.getFullYear();
  filtroFim.value = formatarBR(hoje);
  atualizarGrafico();
}

  function filtrarClientes(){
  const termo = document.getElementById("buscaCliente").value.toLowerCase();

  const itens = listaClientes.getElementsByTagName("li");

  for(let i = 0; i < itens.length; i++){
    const texto = itens[i].innerText.toLowerCase();

    if(texto.includes(termo)){
      itens[i].style.display = "block";
    } else {
      itens[i].style.display = "none";
    }
  }
}


function togglePainel(){
  painelClientes.style.display =
    painelClientes.style.display==="block"?"none":"block";
  renderClientes();
}

function renderClientes(){
  listaClientes.innerHTML="";

  clientes.forEach(c=>{
    const li=document.createElement("li");
   li.innerHTML=`
  <div style="display:flex; flex-direction:column; gap:6px;">
    <strong style="font-size:15px;">${c.nome}</strong>

    <span style="color:#38bdf8;">
      ${Number(c.valor).toLocaleString('pt-BR',{style:'currency',currency:'BRL'})} / m√™s
    </span>

    <span>
  Status: 
  <strong style="color:${
    c.status === "Ativo" ? "#22c55e" :
    c.status === "Em teste" ? "#facc15" :
    "#ef4444"
  }">
    ${c.status || "Ativo"}
  </strong>
</span>

<div style="display:flex; gap:6px; margin-top:6px;">

  <button class="btn" 
    style="
      background:${c.status === 'Ativo' ? '#22c55e' : 'linear-gradient(135deg,#2563eb,#38bdf8)'};
      font-size:12px; 
      padding:8px;
    "
    onclick="mudarStatus(${c.id}, 'Ativo')">
    Ativo
  </button>

  <button class="btn" 
    style="
      background:${c.status === 'Em teste' ? '#facc15' : 'linear-gradient(135deg,#2563eb,#38bdf8)'};
      color:${c.status === 'Em teste' ? '#020617' : 'white'};
      font-size:12px; 
      padding:8px;
    "
    onclick="mudarStatus(${c.id}, 'Em teste')">
    Em teste
  </button>

  <button class="btn" 
    style="
      background:${c.status === 'Inativo' ? '#ef4444' : 'linear-gradient(135deg,#2563eb,#38bdf8)'};
      font-size:12px; 
      padding:8px;
    "
    onclick="mudarStatus(${c.id}, 'Inativo')">
    Inativo
  </button>

</div>




    <button class="btn" onclick="removerCliente(${c.id})" 
      style="margin-top:6px; width:100%;">
      Excluir
    </button>
  </div>
`;

    listaClientes.appendChild(li);
  });
}

function removerCliente(id){
 const cliente = clientes.find(c => c.id === id);

if(cliente){
  registrarNotificacao(`Cliente removido: ${cliente.nome}`);
}


  atualizarGrafico();
  calcularReceitaTotal();
  renderClientes();
}

  function mudarStatus(id, novoStatus){
  clientes = clientes.map(c => {
    if(c.id === id){
      return {...c, status: novoStatus};
    }
    return c;
  });

  localStorage.setItem("clientes", JSON.stringify(clientes));
  renderClientes();

  registrarNotificacao(
    `Status do cliente alterado para: ${novoStatus}`
  );
}


function atualizarGrafico(){
  let inicioFiltro = filtroInicio.value 
    ? converterBRparaDate(filtroInicio.value) 
    : null;

  let fimFiltro = filtroFim.value 
    ? converterBRparaDate(filtroFim.value) 
    : new Date();

  let labels = [];
  let datasets = [];

  clientes.forEach((c,i)=>{
    let data = converterBRparaDate(c.inicio);
    if(!data) return;
    let total = 0;
    let dados = [];
    let meses = [];

    while(data <= fimFiltro){
      if(!inicioFiltro || data >= inicioFiltro){
        total += c.valor;
        meses.push(formatarDataBR(data.toISOString().split("T")[0]));
        dados.push(total);
      }
      data.setMonth(data.getMonth()+1);
    }

    labels = meses;

    datasets.push({
      label:c.nome,
      data:dados,
      borderColor:["#38bdf8","#22c55e","#facc15","#ef4444"][i%4]
    });
  });

  chart.data.labels = labels;
  chart.data.datasets = datasets;
  chart.update();
}

function adicionarTarefa(){
 tarefas.push({
  data:tData.value,
  hora:tHora.value,
  desc:tDesc.value,
  concluida:false
 });


  localStorage.setItem("tarefas",JSON.stringify(tarefas));
  renderTarefas();
}

function renderTarefas(){
  listaTarefas.innerHTML="";

  tarefas.forEach((t, index)=>{
    const li=document.createElement("li");

    li.innerHTML = `
      <div class="${t.concluida ? 'tarefa-concluida' : ''}">
        ${formatarDataBR(t.data)} ${t.hora} ‚Äî ${t.desc}
      </div>

      <div class="btn-group">
        <button class="btn-edit" onclick="editarTarefa(${index})">Editar</button>
        <button class="btn-done" onclick="concluirTarefa(${index})">
          ${t.concluida ? 'Desfazer' : 'Conclu√≠do'}
        </button>
        <button class="btn-del" onclick="excluirTarefa(${index})">Excluir</button>
      </div>
    `;

    listaTarefas.appendChild(li);
  });
}

function excluirTarefa(i){
  tarefas.splice(i,1);
  localStorage.setItem("tarefas",JSON.stringify(tarefas));
  renderTarefas();
}

function concluirTarefa(i){
  tarefas[i].concluida = !tarefas[i].concluida;
  localStorage.setItem("tarefas",JSON.stringify(tarefas));
  renderTarefas();
}

function editarTarefa(i){
  const novaDesc = prompt("Editar tarefa:", tarefas[i].desc);

  if(novaDesc){
    tarefas[i].desc = novaDesc;
    localStorage.setItem("tarefas",JSON.stringify(tarefas));
    renderTarefas();
  }
}

renderClientes();
renderTarefas();
calcularReceitaTotal();
atualizarGrafico();
atualizarPainelNotificacoes();

window.addEventListener('scroll', function(){
  document.getElementById('painelNotificacoes').style.display = 'none';
  document.getElementById('painelClientes').style.display = 'none';
});

  window.addEventListener("resize", () => chart.resize());

</script>
  
</body>
</html>
